<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voxa Store</title>

  <style>
    :root{
      --bg:#0b1220; --panel:#0c162b; --text:#eaf0ff; --muted:#a9b7d7;
      --brand:#4aa3ff; --ok:#29d17d; --danger:#ff5c7a; --warn:#ffcc66;
      --border:rgba(255,255,255,.08); --radius:18px; --shadow:0 18px 50px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial;
      background:
        radial-gradient(1200px 600px at 80% -10%, rgba(74,163,255,.25), transparent 60%),
        radial-gradient(900px 500px at 20% 0%, rgba(41,209,125,.16), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
    }

    .app{display:grid;grid-template-columns:320px 1fr;min-height:100vh}
    aside{
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent 40%), var(--panel);
      padding:18px;
      border-left:1px solid var(--border);
      position:sticky; top:0; height:100vh;
    }
    main{padding:24px 24px 40px}

    @media (max-width:980px){
      .app{grid-template-columns:1fr}
      aside{position:fixed; inset:0; width:min(92vw,360px); height:auto;
        transform: translateX(110%); transition:.25s ease; z-index:50;
        border-left:none; border-right:1px solid var(--border);
      }
      aside.open{transform: translateX(0)}
      .overlay{position:fixed; inset:0; background: rgba(0,0,0,.55); z-index:40;
        opacity:0; pointer-events:none; transition:.2s ease;
      }
      .overlay.show{opacity:1; pointer-events:auto}
      main{padding:18px 16px 30px}
      .topbar{display:flex}
    }

    .topbar{
      display:none;
      position:sticky; top:0; z-index:10; padding:14px 16px;
      background: rgba(11,18,32,.7); backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
      gap:10px; align-items:center; justify-content:space-between;
    }
    .burger{border:1px solid var(--border); background: rgba(255,255,255,.04); color:var(--text);
      border-radius:14px; padding:10px 12px; cursor:pointer; font-weight:900;
    }
    .overlay{display:block}

    .logo{
      display:flex; gap:12px; align-items:center; padding:14px;
      border:1px solid var(--border); border-radius: var(--radius);
      background: rgba(255,255,255,.04); box-shadow: var(--shadow);
    }
    .badge{
      width:44px; height:44px; border-radius:14px;
      background: linear-gradient(135deg, rgba(74,163,255,.9), rgba(41,209,125,.7));
      display:grid; place-items:center; font-weight:900;
    }
    .logo h1{margin:0; font-size:16px}
    .logo p{margin:3px 0 0; color:var(--muted); font-size:12px; line-height:1.6}

    nav{margin-top:16px; display:flex; flex-direction:column; gap:10px}
    .navbtn{
      display:flex; gap:10px; align-items:center; width:100%;
      padding:12px 14px; border-radius:16px; border:1px solid var(--border);
      background: rgba(255,255,255,.03); color:var(--text); cursor:pointer; text-align:right;
      transition:.15s ease;
    }
    .navbtn:hover{transform: translateY(-1px); background: rgba(255,255,255,.06)}
    .navbtn.active{background: rgba(74,163,255,.14); border-color: rgba(74,163,255,.35)}
    .navicon{
      width:34px; height:34px; border-radius:12px; background: rgba(255,255,255,.06);
      display:grid; place-items:center; border:1px solid var(--border); flex:0 0 auto;
    }
    .navtext .t{font-weight:900}
    .navtext .d{font-size:12px; color:var(--muted); margin-top:2px}

    .sidecard{
      margin-top:14px; padding:14px; border-radius: var(--radius);
      border:1px solid var(--border); background: rgba(255,255,255,.03);
    }
    .small{color:var(--muted); font-size:12px; line-height:1.7}
    .pilllink{
      display:inline-flex; align-items:center; gap:10px; margin-top:10px;
      padding:10px 12px; border-radius:14px; border:1px solid rgba(74,163,255,.35);
      background: rgba(74,163,255,.10); color:var(--text); text-decoration:none; font-weight:900;
    }

    .pagehead{display:flex; justify-content:space-between; align-items:flex-start; gap:16px; margin-bottom:14px}
    .pagehead h2{margin:0; font-size:24px}
    .pagehead p{margin:6px 0 0; color:var(--muted); line-height:1.8; max-width:70ch}
    .chiprow{display:flex; flex-wrap:wrap; gap:8px; justify-content:flex-end}
    .chip{font-size:12px; padding:7px 10px; border-radius:999px; border:1px solid var(--border);
      background: rgba(255,255,255,.03); color:var(--muted);
    }

    .grid{display:grid; grid-template-columns: repeat(12, 1fr); gap:14px; margin-top:16px}
    .card{
      grid-column: span 6; padding:16px; border-radius: var(--radius); border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      box-shadow: var(--shadow); min-height:120px;
    }
    .card.full{grid-column:span 12}
    .card h3{margin:0 0 8px; font-size:16px}
    .card p{margin:0; color:var(--muted); line-height:1.8}

    .meta{margin-top:12px; display:flex; gap:8px; flex-wrap:wrap}
    .tag{font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background: rgba(255,255,255,.03); color:var(--muted)}
    .tag.ok{color:var(--ok); border-color: rgba(41,209,125,.35); background: rgba(41,209,125,.10)}
    .tag.warn{color:var(--warn); border-color: rgba(255,204,102,.35); background: rgba(255,204,102,.10)}
    .tag.danger{color:var(--danger); border-color: rgba(255,92,122,.35); background: rgba(255,92,122,.10)}

    @media (max-width:980px){
      .card{grid-column: span 12}
      .pagehead{flex-direction:column; align-items:flex-start}
      .chiprow{justify-content:flex-start}
    }

    .tabs{display:flex; gap:8px; flex-wrap:wrap; margin-top:14px}
    .tab{
      border:1px solid var(--border); background: rgba(255,255,255,.03); color:var(--text);
      padding:8px 10px; border-radius:999px; font-weight:900; cursor:pointer; font-size:12px;
    }
    .tab.active{border-color: rgba(74,163,255,.45); background: rgba(74,163,255,.16)}

    .emptybox{
      grid-column: span 12; padding:18px; border-radius: var(--radius);
      border:1px dashed rgba(255,255,255,.18); background: rgba(255,255,255,.02);
      color: var(--muted); line-height:1.9;
    }

    form{
      margin-top:12px; max-width: 820px; border:1px solid var(--border);
      border-radius: var(--radius); background: rgba(255,255,255,.03);
      padding:16px; box-shadow: var(--shadow);
    }
    .fgrid{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
    @media (max-width:980px){ .fgrid{grid-template-columns:1fr} }
    label{font-size:12px; color:var(--muted); display:block; margin-bottom:6px}
    input, textarea, select{
      width:100%; border-radius: 14px; border:1px solid var(--border);
      background: rgba(0,0,0,.18); padding:10px 12px; color:var(--text);
      outline:none; font-size:14px;
    }
    textarea{min-height:110px; resize:vertical}

    .btn{
      cursor:pointer; border:1px solid var(--border); background: rgba(255,255,255,.04);
      color:var(--text); padding:10px 12px; border-radius:14px; font-weight:900;
    }
    .btn.primary{border-color: rgba(74,163,255,.45); background: rgba(74,163,255,.16)}
    .btn.ok{border-color: rgba(41,209,125,.45); background: rgba(41,209,125,.14)}
    .btn.danger{border-color: rgba(255,92,122,.45); background: rgba(255,92,122,.14)}
    .btn.small{padding:8px 10px; border-radius:12px; font-weight:800}

    /* Cart */
    .cartItem{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-top:10px}
    .total{font-weight:900}
    .checkoutBox{display:none;margin-top:14px}

    section.page{display:none}
    section.page.active{display:block}
  </style>
</head>

<body>
  <div class="topbar">
    <button class="burger" id="openMenu">â˜° Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
    <div style="font-weight:900">Voxa Store</div>
  </div>
  <div class="overlay" id="overlay"></div>

  <div class="app">
    <aside id="sidebar">
      <div class="logo">
        <div class="badge">VX</div>
        <div>
          <h1>Voxa Store</h1>
          <p>Marketplace Ø±Ø³Ù…ÙŠ</p>
        </div>
      </div>

      <nav>
        <button class="navbtn active" data-page="about">
          <div class="navicon">â„¹ï¸</div>
          <div class="navtext"><div class="t">About us</div><div class="d">ØªØ·Ø¨ÙŠÙ„ + Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</div></div>
        </button>

        <button class="navbtn" data-page="shop">
          <div class="navicon">ğŸ›’</div>
          <div class="navtext"><div class="t">Shop</div><div class="d">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª + Ø§Ù„Ø³Ù„Ø©</div></div>
        </button>

        <button class="navbtn" data-page="sellers">
          <div class="navicon">ğŸ‘¤</div>
          <div class="navtext"><div class="t">Sellers</div><div class="d">Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†</div></div>
        </button>

        <button class="navbtn" data-page="proofs">
          <div class="navicon">âœ…</div>
          <div class="navtext"><div class="t">Proofs</div><div class="d">Ø¥Ø«Ø¨Ø§ØªØ§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div></div>
        </button>

        <button class="navbtn" data-page="payments">
          <div class="navicon">ğŸ’³</div>
          <div class="navtext"><div class="t">Payments</div><div class="d">Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div></div>
        </button>

        <button class="navbtn" data-page="support">
          <div class="navicon">ğŸ› ï¸</div>
          <div class="navtext"><div class="t">Support</div><div class="d">ØªÙ‚Ø¯ÙŠÙ… Ù…Ø´ÙƒÙ„Ø©</div></div>
        </button>
      </nav>

      <div class="sidecard">
        <div class="small">Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†:</div>
        <a class="pilllink" href="panel.html">ÙØªØ­ Admin Panel</a>
        <div class="small" style="margin-top:10px">
          * Ù…Ù‡Ù…: Ù„Ø§Ø²Ù… ØªÙØªØ­ panel ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ù†ÙØ³ Ø±Ø§Ø¨Ø· github.io Ø¹Ø´Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¸Ù‡Ø±.
        </div>
      </div>
    </aside>

    <main>
      <!-- ABOUT -->
      <section class="page active" id="page-about">
        <div class="pagehead">
          <div>
            <h2>About us</h2>
            <p>
              Ø¥Ø­Ù†Ø§ Voxa Store â€” Ø£Ø­Ø³Ù† Ø³ØªÙˆØ± ÙÙŠ Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø· ğŸ”¥<br/>
              Ù…Ø¹Ø§Ù†Ø§ <b>190 Ø¯Ù„ÙŠÙ„</b> ÙˆØ¨Ø§Ø¦Ø¹ÙŠÙ† Ø¬Ø§Ù…Ø¯ÙŠÙ† Ø¬Ø¯Ù‹Ø§ØŒ Ø´ØºØ§Ù„ÙŠÙ† <b>24 Ø³Ø§Ø¹Ø©</b>.
            </p>
          </div>
          <div class="chiprow">
            <span class="chip">ğŸ“˜ 190 Ø¯Ù„ÙŠÙ„</span>
            <span class="chip">ğŸ”¥ Sellers Ø¬Ø§Ù…Ø¯ÙŠÙ†</span>
            <span class="chip">â±ï¸ 24/7</span>
          </div>
        </div>

        <div class="grid">
          <div class="card">
            <h3>Ù„ÙŠÙ‡ Ø¥Ø­Ù†Ø§ØŸ</h3>
            <p>ØªÙ†Ø¸ÙŠÙ…ØŒ Ø³Ø±Ø¹Ø©ØŒ Ø¯Ø¹Ù… Ù…Ø­ØªØ±Ù…ØŒ ÙˆØªØ¬Ø±Ø¨Ø© Ø´ÙƒÙ„Ù‡Ø§ Ø¬Ø§Ù…Ø¯.</p>
            <div class="meta">
              <span class="tag">Ø«Ù‚Ø©</span><span class="tag">Ø³Ø±Ø¹Ø©</span><span class="tag">Ø¯Ø¹Ù…</span>
            </div>
          </div>
          <div class="card">
            <h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø´ÙˆØ¨</h3>
            <p>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨ØªØªØ­Ø· Ù…Ù† Admin Panel ÙˆØªØ¸Ù‡Ø± Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠ.</p>
            <div class="meta">
              <span class="tag">Supplies</span><span class="tag">Orders</span><span class="tag">Issues</span>
            </div>
          </div>
        </div>
      </section>

      <!-- SHOP -->
      <section class="page" id="page-shop">
        <div class="pagehead">
          <div>
            <h2>Shop</h2>
            <p>Ø§Ø®ØªØ§Ø± Ù‚Ø³Ù… ÙˆØ´ÙˆÙ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. ØªÙ‚Ø¯Ø± ØªØ¶ÙŠÙ Ù„Ù„Ø³Ù„Ø© Ø£Ùˆ ØªØ´ØªØ±ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
          </div>
          <div class="chiprow">
            <span class="chip" id="shopCountChip">â€¦</span>
          </div>
        </div>

        <div class="tabs" id="categoryTabs"></div>
        <div class="grid" id="shopGrid"></div>

        <div class="grid">
          <div class="card full">
            <h3>ğŸ›’ Ø§Ù„Ø³Ù„Ø©</h3>
            <div id="cartList" style="margin-top:10px;color:var(--muted)">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø¶ÙŠØ©.</div>

            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;align-items:center">
              <span class="total" id="cartTotal">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0 EGP</span>
              <button class="btn ok" id="checkoutBtn">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡</button>
              <button class="btn small" id="clearCartBtn">ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©</button>
            </div>

            <div class="checkoutBox" id="checkoutBox">
              <div class="card full" style="background:rgba(0,0,0,.15); margin-top:14px">
                <h3>ğŸ§¾ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±Ø§Ø¡</h3>

                <div class="fgrid" style="margin-top:12px">
                  <div>
                    <label>Ø§Ø³Ù…Ùƒ</label>
                    <input id="coName" placeholder="Ø§Ø³Ù…Ùƒ" />
                  </div>
                  <div>
                    <label>ÙˆØ³ÙŠÙ„Ø© Ø§Ù„ØªÙˆØ§ØµÙ„</label>
                    <input id="coContact" placeholder="Discord ID / Username / Ø±Ø§Ø¨Ø·..." />
                  </div>
                </div>

                <div style="margin-top:12px">
                  <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
                  <select id="coPay">
                    <option value="crypto">ÙƒØ±ÙŠØ¨ØªÙˆ</option>
                    <option value="instapay">Ø¥Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ</option>
                    <option value="paypal">Ø¨Ø§ÙŠØ¨Ø§Ù„</option>
                    <option value="vodafone">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</option>
                    <option value="sar">Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</option>
                    <option value="asiacell">Ø¢Ø³ÙŠØ§ Ø³ÙŠÙ„</option>
                  </select>
                </div>

                <button class="btn primary" id="confirmOrderBtn" style="margin-top:12px">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
                <p id="coNote" style="margin-top:10px;color:var(--muted)"></p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- SELLERS -->
      <section class="page" id="page-sellers">
        <div class="pagehead">
          <div>
            <h2>Sellers</h2>
            <p>Ø¯ÙˆÙ„ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ† Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ÙŠÙ† Ø¹Ù†Ø¯Ù†Ø§ (Ø¨ÙŠØªØ­Ø¯Ø¯ÙˆØ§ Ù…Ù† Admin Panel).</p>
          </div>
          <div class="chiprow">
            <span class="chip" id="sellersCountChip">â€¦</span>
          </div>
        </div>

        <div class="grid" id="sellersGrid"></div>
      </section>

      <!-- PROOFS -->
      <section class="page" id="page-proofs">
        <div class="pagehead">
          <div>
            <h2>Proofs</h2>
            <p>Ø¯ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù„ÙŠ Ø§Ù„Ø£Ø¯Ù…Ù† Ø¹Ù…Ù„Ù‡Ø§ Done. (Ø¨Ø¯ÙˆÙ† Ø£Ø²Ø±Ø§Ø±)</p>
          </div>
          <div class="chiprow">
            <span class="chip" id="proofsCountChip">â€¦</span>
          </div>
        </div>
        <div class="grid" id="proofsGrid"></div>
      </section>

      <!-- PAYMENTS -->
      <section class="page" id="page-payments">
        <div class="pagehead">
          <div>
            <h2>Payments</h2>
            <p>Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©.</p>
          </div>
          <div class="chiprow">
            <span class="chip">ğŸ’³ Ø¯ÙØ¹</span>
          </div>
        </div>

        <div class="grid" id="paymentsGrid"></div>
      </section>

      <!-- SUPPORT -->
      <section class="page" id="page-support">
        <div class="pagehead">
          <div>
            <h2>Support</h2>
            <p>Ù‚Ø¯Ù‘Ù… Ù…Ø´ÙƒÙ„Ø©/ØªØ°ÙƒØ±Ø©ØŒ ÙˆÙ‡ØªØ¸Ù‡Ø± ÙÙŠ Admin Panel ØªØ­Øª Issues.</p>
          </div>
          <div class="chiprow">
            <span class="chip">ğŸ§¾ Issues</span>
            <span class="chip">âš¡ Ø±Ø¯ Ø³Ø±ÙŠØ¹</span>
          </div>
        </div>

        <form id="issueForm">
          <div class="fgrid">
            <div>
              <label>Ø§Ø³Ù…Ùƒ</label>
              <input name="name" required placeholder="Ø§Ø³Ù…Ùƒ" />
            </div>
            <div>
              <label>ÙˆØ³ÙŠÙ„Ø© ØªÙˆØ§ØµÙ„ (Discord/Ø±Ù‚Ù…/Ø¥ÙŠÙ…ÙŠÙ„)</label>
              <input name="contact" required placeholder="discordUser#0001" />
            </div>
          </div>

          <div style="margin-top:12px">
            <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label>
            <select name="type" required>
              <option value="payment">Ù…Ø´ÙƒÙ„Ø© Ø¯ÙØ¹</option>
              <option value="order">Ù…Ø´ÙƒÙ„Ø© Ø·Ù„Ø¨</option>
              <option value="seller">Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ø¦Ø¹</option>
              <option value="other">Ø£Ø®Ø±Ù‰</option>
            </select>
          </div>

          <div style="margin-top:12px">
            <label>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label>
            <textarea name="details" required placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„â€¦"></textarea>
          </div>

          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn ok" type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</button>
            <button class="btn small" type="reset">Ù…Ø³Ø­</button>
          </div>

          <p class="small" id="issueNote" style="margin-top:10px"></p>
        </form>
      </section>
    </main>
  </div>

  <script>
    // ===== Mobile Sidebar =====
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");
    const openMenu = document.getElementById("openMenu");
    openMenu?.addEventListener("click", ()=>{ sidebar.classList.add("open"); overlay.classList.add("show"); });
    overlay?.addEventListener("click", ()=>{ sidebar.classList.remove("open"); overlay.classList.remove("show"); });

    // ===== Pages =====
    const navButtons = Array.from(document.querySelectorAll(".navbtn"));
    const pages = {
      about: document.getElementById("page-about"),
      shop: document.getElementById("page-shop"),
      sellers: document.getElementById("page-sellers"),
      proofs: document.getElementById("page-proofs"),
      payments: document.getElementById("page-payments"),
      support: document.getElementById("page-support"),
    };

    function setActivePage(key){
      Object.values(pages).forEach(p => p.classList.remove("active"));
      pages[key].classList.add("active");
      navButtons.forEach(b => b.classList.toggle("active", b.dataset.page === key));
      history.replaceState(null, "", "#" + key);
      if (window.innerWidth <= 980){
        sidebar.classList.remove("open");
        overlay.classList.remove("show");
      }
    }
    navButtons.forEach(btn => btn.addEventListener("click", ()=> setActivePage(btn.dataset.page)));
    const initial = (location.hash || "#about").replace("#","");
    if (pages[initial]) setActivePage(initial);

    // ===== Storage Keys (Shared with Admin Panel) =====
    const KEY_SELLERS = "voxa_sellers";
    const KEY_SUPPLY  = "voxa_supplies";
    const KEY_ISSUES  = "voxa_issues";
    const KEY_ORDERS  = "voxa_orders";
    const KEY_PROOFS  = "voxa_proofs";
    const KEY_CART    = "voxa_cart";

    const DEFAULT_SELLERS = ["gq_8", "k_i_l_"];
    const CATEGORIES = ["nitros","credits","visas","effects","boosts","accounts"];

    // ===== Utils =====
    function safeJSONParse(raw, fallback){
      try{ return JSON.parse(raw); }catch{ return fallback; }
    }
    function esc(s){
      return String(s||"")
        .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
        .replaceAll('"',"&quot;").replaceAll("'","&#039;");
    }

    // ===== Sellers =====
    const sellersGrid = document.getElementById("sellersGrid");
    const sellersCountChip = document.getElementById("sellersCountChip");

    function loadSellers(){
      const raw = localStorage.getItem(KEY_SELLERS);
      const arr = raw ? safeJSONParse(raw, DEFAULT_SELLERS) : DEFAULT_SELLERS;
      return Array.isArray(arr) && arr.length ? arr : DEFAULT_SELLERS;
    }
    function renderSellers(){
      const sellers = loadSellers();
      sellersCountChip.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†: ${sellers.length}`;
      sellersGrid.innerHTML = sellers.map(u=>`
        <div class="card">
          <h3>@${esc(u)}</h3>
          <p>Ø¨Ø§Ø¦Ø¹ Ù…Ø¹ØªÙ…Ø¯ Ø¯Ø§Ø®Ù„ Voxa Store.</p>
          <div class="meta">
            <span class="tag ok">Verified</span>
            <span class="tag">24/7</span>
          </div>
        </div>
      `).join("");
    }

    // ===== Proofs =====
    const proofsGrid = document.getElementById("proofsGrid");
    const proofsCountChip = document.getElementById("proofsCountChip");

    function loadProofs(){
      const raw = localStorage.getItem(KEY_PROOFS);
      const arr = raw ? safeJSONParse(raw, []) : [];
      return Array.isArray(arr) ? arr : [];
    }

    function renderProofs(){
      const proofs = loadProofs();
      proofsCountChip.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø«Ø¨Ø§ØªØ§Øª: ${proofs.length}`;

      if(!proofs.length){
        proofsGrid.innerHTML = `
          <div class="emptybox">
            Ù…ÙÙŠØ´ Proofs Ù„Ø³Ù‡. Ø£ÙˆÙ„ Ù…Ø§ Ø§Ù„Ø£Ø¯Ù…Ù† ÙŠØ¹Ù…Ù„ Done Ù„Ø·Ù„Ø¨ Ù…Ù† Panel â†’ Orders Ù‡ÙŠØªÙ†Ù‚Ù„ Ù‡Ù†Ø§.
          </div>
        `;
        return;
      }

      proofsGrid.innerHTML = proofs.map(p=>`
        <div class="card">
          <h3>${esc(p.details)}</h3>
          <p>
            Ø§Ù„Ø¹Ù…ÙŠÙ„: <b style="color:var(--text)">${esc(p.customer)}</b><br/>
            Ù…Ø³ØªÙ„Ù… Ø¨ÙˆØ§Ø³Ø·Ø©: <b style="color:var(--text)">${esc(p.claimedBy||"â€”")}</b>
          </p>
          <div class="meta">
            <span class="tag ok">Done</span>
            <span class="tag">ÙˆÙ‚Øª: ${p.doneAt ? esc(new Date(p.doneAt).toLocaleString()) : "â€”"}</span>
          </div>
        </div>
      `).join("");
    }

    // ===== Supplies / Shop =====
    const categoryTabs = document.getElementById("categoryTabs");
    const shopGrid = document.getElementById("shopGrid");
    const shopCountChip = document.getElementById("shopCountChip");
    let activeCategory = CATEGORIES[0];

    function loadSupplies(){
      const raw = localStorage.getItem(KEY_SUPPLY);
      const arr = raw ? safeJSONParse(raw, []) : [];
      return Array.isArray(arr) ? arr : [];
    }

    // ===== Cart =====
    const cartList = document.getElementById("cartList");
    const cartTotal = document.getElementById("cartTotal");
    const checkoutBtn = document.getElementById("checkoutBtn");
    const clearCartBtn = document.getElementById("clearCartBtn");
    const checkoutBox = document.getElementById("checkoutBox");
    const confirmOrderBtn = document.getElementById("confirmOrderBtn");
    const coName = document.getElementById("coName");
    const coContact = document.getElementById("coContact");
    const coPay = document.getElementById("coPay");
    const coNote = document.getElementById("coNote");

    function loadCart(){
      const raw = localStorage.getItem(KEY_CART);
      const arr = raw ? safeJSONParse(raw, []) : [];
      return Array.isArray(arr) ? arr : [];
    }
    function saveCart(arr){ localStorage.setItem(KEY_CART, JSON.stringify(arr)); }
    function cartTotalEGP(cart){
      return cart.reduce((sum,it)=> sum + (Number(it.price)||0) * (Number(it.qty)||1), 0);
    }

    function renderCart(){
      const cart = loadCart();
      if(!cart.length){
        cartList.innerHTML = "Ø§Ù„Ø³Ù„Ø© ÙØ§Ø¶ÙŠØ©.";
        cartTotal.textContent = "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0 EGP";
        return;
      }
      cartList.innerHTML = cart.map((it,idx)=>`
        <div class="cartItem">
          <div>
            <b style="color:var(--text)">${esc(it.title)}</b>
            <span class="tag">${Number(it.price)||0} EGP</span>
            <span class="tag">x${Number(it.qty)||1}</span>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn small" data-minus="${idx}">-</button>
            <button class="btn small" data-plus="${idx}">+</button>
            <button class="btn small danger" data-remove="${idx}">Ø­Ø°Ù</button>
          </div>
        </div>
      `).join("");

      cartTotal.textContent = `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${cartTotalEGP(cart)} EGP`;

      cartList.querySelectorAll("[data-plus]").forEach(b=>{
        b.onclick=()=>{
          const i=Number(b.dataset.plus);
          const c=loadCart();
          c[i].qty = (c[i].qty||1)+1;
          saveCart(c); renderCart();
        };
      });
      cartList.querySelectorAll("[data-minus]").forEach(b=>{
        b.onclick=()=>{
          const i=Number(b.dataset.minus);
          const c=loadCart();
          c[i].qty = Math.max(1,(c[i].qty||1)-1);
          saveCart(c); renderCart();
        };
      });
      cartList.querySelectorAll("[data-remove]").forEach(b=>{
        b.onclick=()=>{
          const i=Number(b.dataset.remove);
          const c=loadCart();
          c.splice(i,1);
          saveCart(c); renderCart();
        };
      });
    }

    function addToCart(prod){
      const cart = loadCart();
      const found = cart.find(x=>x.id===prod.id);
      if(found) found.qty = (found.qty||1)+1;
      else cart.push({ ...prod, qty:1 });
      saveCart(cart);
      renderCart();
    }

    function renderShop(){
      categoryTabs.innerHTML = CATEGORIES.map(c=>`
        <button class="tab ${c===activeCategory ? "active":""}" data-cat="${c}">${c}</button>
      `).join("");
      categoryTabs.querySelectorAll("[data-cat]").forEach(b=>{
        b.onclick=()=>{ activeCategory = b.dataset.cat; renderShop(); };
      });

      const all = loadSupplies();
      const items = all.filter(p => p.category === activeCategory);
      shopCountChip.textContent = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${all.length}`;

      if(!items.length){
        shopGrid.innerHTML = `
          <div class="emptybox">
            <b style="color:var(--text)">Ù‚Ø³Ù…: ${activeCategory}</b><br/>
            Ù…ÙÙŠØ´ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø³Ù… Ø¯Ù‡ Ù„Ø³Ù‡. Ø¶ÙŠÙ Ù…Ù† Admin Panel â†’ Supplies.
          </div>
        `;
        renderCart();
        return;
      }

      shopGrid.innerHTML = items.map(p=>`
        <div class="card">
          <h3>${esc(p.title)}</h3>
          <p>${esc(p.desc)}</p>
          <div class="meta">
            <span class="tag">${Number(p.price)||0} EGP</span>
            <span class="tag">Seller: @${esc(p.seller || "â€”")}</span>
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px">
            <button class="btn primary" data-buy="${esc(p.id)}">Ø´Ø±Ø§Ø¡</button>
            <button class="btn ok" data-add="${esc(p.id)}">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
          </div>
        </div>
      `).join("");

      // Add / Buy
      shopGrid.querySelectorAll("[data-add]").forEach(btn=>{
        btn.onclick=()=>{
          const id = btn.dataset.add;
          const prod = loadSupplies().find(x=>x.id===id);
          if(!prod) return;
          addToCart({ id: prod.id, title: prod.title, price: Number(prod.price)||0, seller: prod.seller||"", category: prod.category });
          alert("âœ… Ø§ØªØ¶Ø§Ù Ù„Ù„Ø³Ù„Ø©");
        };
      });

      shopGrid.querySelectorAll("[data-buy]").forEach(btn=>{
        btn.onclick=()=>{
          const id = btn.dataset.buy;
          const prod = loadSupplies().find(x=>x.id===id);
          if(!prod) return;
          addToCart({ id: prod.id, title: prod.title, price: Number(prod.price)||0, seller: prod.seller||"", category: prod.category });
          checkoutBox.style.display = "block";
          window.scrollTo({top: document.body.scrollHeight, behavior:"smooth"});
        };
      });

      renderCart();
    }

    // ===== Payments =====
    const paymentsGrid = document.getElementById("paymentsGrid");
    const paymentMethods = [
      "ÙƒØ±ÙŠØ¨ØªÙˆ (USDT / TRC20 / ERC20â€¦)",
      "Ø¥Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ",
      "Ø¨Ø§ÙŠØ¨Ø§Ù„",
      "ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´",
      "Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ (ÙƒÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª)",
      "Ø¢Ø³ÙŠØ§ Ø³ÙŠÙ„ (ÙƒÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª)"
    ];
    paymentsGrid.innerHTML = paymentMethods.map(m=>`
      <div class="card">
        <h3>${esc(m)}</h3>
        <p>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ù‚Ø¨Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ù„ØªØ£ÙƒÙŠØ¯.</p>
        <div class="meta"><span class="tag ok">Ù…ØªØ§Ø­</span></div>
      </div>
    `).join("");

    // ===== Checkout Actions =====
    clearCartBtn.onclick = ()=>{
      saveCart([]);
      renderCart();
      coNote.textContent = "";
    };

    checkoutBtn.onclick = ()=>{
      checkoutBox.style.display = (checkoutBox.style.display === "block") ? "none" : "block";
      coNote.textContent = "";
    };

    confirmOrderBtn.onclick = ()=>{
      const name = (coName.value||"").trim();
      const contact = (coContact.value||"").trim();
      const pay = coPay.value;

      const cart = loadCart();
      if(!cart.length){
        coNote.textContent = "âŒ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø¶ÙŠØ©.";
        return;
      }
      if(!name || !contact){
        coNote.textContent = "âŒ Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… ÙˆÙˆØ³ÙŠÙ„Ø© Ø§Ù„ØªÙˆØ§ØµÙ„.";
        return;
      }

      const total = cartTotalEGP(cart);
      const details = cart.map(x=>`${x.title} x${x.qty}`).join(" | ");

      const orders = safeJSONParse(localStorage.getItem(KEY_ORDERS) || "[]", []);
      orders.unshift({
        id: Date.now().toString(),
        at: new Date().toISOString(),
        customer: name,
        contact: contact,
        details: `${details} | Pay:${pay} | Total:${total} EGP`,
        status: "open",
        claimState: "unclaimed",
        claimedBy: "",
        claimedAt: ""
      });
      localStorage.setItem(KEY_ORDERS, JSON.stringify(orders));

      saveCart([]);
      renderCart();

      coName.value = "";
      coContact.value = "";
      coNote.textContent = "âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨! Ù‡ØªÙ„Ø§Ù‚ÙŠÙ‡ ÙÙŠ Admin Panel â†’ Orders.";
    };

    // ===== Support -> Issues =====
    const issueForm = document.getElementById("issueForm");
    const issueNote = document.getElementById("issueNote");

    function loadIssues(){
      const raw = localStorage.getItem(KEY_ISSUES);
      const arr = raw ? safeJSONParse(raw, []) : [];
      return Array.isArray(arr) ? arr : [];
    }
    function saveIssues(arr){ localStorage.setItem(KEY_ISSUES, JSON.stringify(arr)); }
    function uid(){ return "i_" + Math.random().toString(16).slice(2) + Date.now().toString(16); }

    issueForm.addEventListener("submit", (e)=>{
      e.preventDefault();
      const fd = new FormData(issueForm);
      const issue = {
        id: uid(),
        at: new Date().toISOString(),
        name: String(fd.get("name")||"").trim(),
        contact: String(fd.get("contact")||"").trim(),
        type: String(fd.get("type")||"").trim(),
        details: String(fd.get("details")||"").trim(),
        status: "open",
        replies: []
      };
      const all = loadIssues();
      all.unshift(issue);
      saveIssues(all);

      issueNote.textContent = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©. Ù‡ØªØ¸Ù‡Ø± ÙÙŠ Admin Panel â†’ Issues.";
      issueForm.reset();
      setTimeout(()=> issueNote.textContent = "", 3500);
    });

    // ===== Init =====
    window.addEventListener("storage", ()=>{
      renderSellers();
      renderShop();
      renderCart();
      renderProofs();
    });

    renderSellers();
    renderShop();
    renderCart();
    renderProofs();
  </script>
</body>
</html>
